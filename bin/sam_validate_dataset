#!/usr/bin/env python

from fife_sam_utils import dataset
import sys
import os

def validate( ds ):
    for p in ds.fullpath_iterator():
        if len(d.ifdh_handle.ls(p,0,'')) == 0:
            print "file path %s not accessible", p

def usage(argv):
    print argv[0], ": usage: "
    print argv[0], "dataset_name1  dataset_name2 ..."
    print "	-- pin files for 30 days in dcache"

if __name__ == '__main__':
    
    cmd = sys.argv[0]
    just_say = False
    if len(sys.argv) > 0 and  sys.argv[1] == '-n':
        just_say = True
        sys.argv = sys.argv[1:]
        sys.argv[0] = cmd

    if len(sys.argv) == 1 or  sys.argv[1] == '-h':
        usage(sys.argv)
        exit(1)

    for ds in sys.argv[1:]:
        validate(dataset(ds), just_say)

