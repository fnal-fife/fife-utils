#!/usr/bin/env python

from fife_sam_utils import *
import hashlib 
import sys
import os

def retire( d ):
    samweb = SAMWebClient()

    for full in d.fullpath_iterator():
        file = basename(full)
        d.ifdh_handle.rm(full, '')
        samweb.removeLocation(file, samprefix(full) + dirname(full))

    for f in d.file_iterator():
        samweb.retireFile(file)

def usage(argv):
    print argv[0], ": usage: "
    print argv[0], "dataset_name1  dataset_name2 ..."
    print "	-- retire files in dataset"

if __name__ == '__main__':
    
    cmd = sys.argv[0]
    just_say = False

    # XXX args for whether to delete files?

    if len(sys.argv) == 1 or  sys.argv[1] == '-h':
        usage(sys.argv)
        exit(1)

    for ds in sys.argv[1:]:
       retire(dataset(ds))

